---
- name: Set root endpoint
  ini_file:
    dest: "{{ splunk.home }}/etc/system/local/web.conf"
    section: settings
    option: "root_endpoint"
    value: "{{ splunk.root_endpoint }}"
  register: set_root_endpoint
  become: yes
  become_user: "{{ splunk.user }}"

# Restart only when Splunk is running and when any of the above have changed
- include_tasks: trigger_restart.yml
  when: set_root_endpoint is changed
